<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>🛠️ محلل الكود المتعدد اللغات</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
            line-height: 1.6;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            text-align: center;
            margin-bottom: 40px;
            color: white;
        }

        header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        header p {
            font-size: 1.2em;
            opacity: 0.9;
        }

        .analyzer-form {
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            margin-bottom: 30px;
        }

        .language-selector, .code-input {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: #555;
            font-size: 1.1em;
        }

        select {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
            background: white;
            transition: border-color 0.3s;
        }

        select:focus {
            border-color: #667eea;
            outline: none;
        }

        textarea {
            width: 100%;
            height: 250px;
            padding: 15px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            resize: vertical;
            transition: border-color 0.3s;
            line-height: 1.4;
        }

        textarea:focus {
            border-color: #667eea;
            outline: none;
        }

        button {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 8px;
            font-size: 18px;
            cursor: pointer;
            width: 100%;
            transition: all 0.3s;
            font-weight: bold;
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        button:active {
            transform: translateY(0);
        }

        .loading {
            text-align: center;
            padding: 30px;
            background: white;
            border-radius: 10px;
            margin-bottom: 20px;
            display: none;
        }

        .loading p {
            font-size: 1.2em;
            color: #667eea;
        }

        .results {
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            display: none;
            margin-bottom: 30px;
        }

        .results h2 {
            color: #333;
            margin-bottom: 20px;
            text-align: center;
        }

        .issue {
            padding: 15px;
            margin: 10px 0;
            border-radius: 8px;
            border-right: 5px solid;
            font-size: 14px;
        }

        .security { 
            border-color: #e74c3c; 
            background: #fdf2f2; 
        }
        .performance { 
            border-color: #f39c12; 
            background: #fef9f3; 
        }
        .complexity { 
            border-color: #3498db; 
            background: #f4f8fe; 
        }
        .best-practice { 
            border-color: #27ae60; 
            background: #f2fcf5; 
        }

        .summary {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 25px;
            border-left: 4px solid #667eea;
        }

        .summary h3 {
            color: #333;
            margin-bottom: 15px;
        }

        .summary p {
            margin: 8px 0;
            font-size: 16px;
        }

        .category {
            margin-bottom: 25px;
        }

        .category h4 {
            color: #555;
            margin-bottom: 15px;
            padding-bottom: 8px;
            border-bottom: 2px solid #eee;
        }

        .success {
            background: #d4edda;
            color: #155724;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            border: 1px solid #c3e6cb;
        }

        .error {
            background: #f8d7da;
            color: #721c24;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            border: 1px solid #f5c6cb;
        }

        .features {
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }

        .features h3 {
            text-align: center;
            margin-bottom: 25px;
            color: #333;
        }

        .language-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .card {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            font-weight: bold;
            transition: transform 0.3s;
        }

        .card:hover {
            transform: translateY(-3px);
        }

        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            header h1 {
                font-size: 2em;
            }
            
            .analyzer-form {
                padding: 20px;
            }
            
            .language-cards {
                grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            }
        }

        /* أحرف متحركة */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }
    </style>
</head>
<body>
    <div class="container">
        <header class="fade-in">
            <h1>🛠️ محلل الكود البرمجي</h1>
            <p>حلل كودك بأي لغة برمجة وحسن من جودته</p>
        </header>

        <div class="analyzer-form fade-in">
            <div class="language-selector">
                <label for="language">اختر لغة البرمجة:</label>
                <select id="language">
                    <option value="python">🐍 Python</option>
                    <option value="lua">🌙 Lua</option>
                    <option value="luau">🎮 Luau (Roblox)</option>
                    <option value="c">🔧 C</option>
                    <option value="cpp">⚡ C++</option>
                    <option value="csharp">💠 C#</option>
                </select>
            </div>

            <div class="code-input">
                <label for="code">الصق كودك هنا:</label>
                <textarea id="code" placeholder="// الصق كودك هنا...&#10;// مثال:&#10;function example() {&#10;    return 'Hello World';&#10;}"></textarea>
            </div>

            <button id="analyze-btn" onclick="analyzeCode()">🔍 تحليل الكود</button>
        </div>

        <div id="loading" class="loading">
            <p>🔄 جاري تحليل الكود...</p>
        </div>

        <div id="results" class="results">
            <h2>📊 نتائج التحليل</h2>
            <div id="results-content"></div>
        </div>

        <div class="features fade-in">
            <h3>🚀 اللغات المدعومة</h3>
            <div class="language-cards">
                <div class="card">🐍 Python</div>
                <div class="card">🌙 Lua</div>
                <div class="card">🎮 Luau</div>
                <div class="card">🔧 C</div>
                <div class="card">⚡ C++</div>
                <div class="card">💠 C#</div>
            </div>
        </div>
    </div>

    <script>
        // أمثلة كود تلقائية
        const examples = {
            python: `def calculate_sum(numbers):\n    total = 0\n    for num in numbers:\n        total += num\n    return total\n\n# مثال على مشكلة أمنية\npassword = "secret123"\n\n# مثال على مشكلة أداء\nresult = ""\nfor i in range(1000):\n    result += str(i)`,
            
            lua: `function factorial(n)\n    if n == 0 then\n        return 1\n    else\n        return n * factorial(n-1)\n    end\nend\n\n-- مثال على مشكلة\nlocal password = "mysecret"`,
            
            luau: `function onPlayerJoin(player)\n    -- مثال على كود Roblox\n    local humanoid = player.Character:FindFirstChild("Humanoid")\n    if humanoid then\n        humanoid.Health = 100\n    end\nend`,
            
            c: `#include <stdio.h>\n\nint main() {\n    int x = 10;\n    printf("Hello World\\n");\n    \n    // مثال على مشكلة\n    char password[] = "secret";\n    return 0;\n}`,
            
            cpp: `#include <iostream>\nusing namespace std;\n\nint main() {\n    int x = 10;\n    cout << "Hello World" << endl;\n    \n    // مثال على مشكلة\n    string api_key = "12345";\n    return 0;\n}`,
            
            csharp: `using System;\n\nclass Program {\n    static void Main() {\n        Console.WriteLine("Hello World");\n        \n        // مثال على مشكلة\n        string password = "mysecret";\n    }\n}`
        };

        // محلل الكود المحلي (يعمل بدون خادم)
        function analyzeCode() {
            const code = document.getElementById('code').value;
            const language = document.getElementById('language').value;
            
            if (!code.trim()) {
                alert('⚠️ الرجاء إدخال كود لتحليله');
                return;
            }

            // إظهار loading
            document.getElementById('loading').style.display = 'block';
            document.getElementById('results').style.display = 'none';

            // محاكاة تحميل الخادم
            setTimeout(() => {
                const result = localCodeAnalysis(code, language);
                displayResults(result);
                document.getElementById('loading').style.display = 'none';
            }, 1500);
        }

        // تحليل محلي بدون خادم
        function localCodeAnalysis(code, language) {
            const issues = {
                security_issues: [],
                performance_issues: [],
                complexity_issues: [],
                best_practice_issues: []
            };

            // تحليل أمني عام
            const securityPatterns = [
                { pattern: /password\s*=\s*["']/, message: 'كلمة سر مخزنة في الكود - استخدم متغيرات البيئة' },
                { pattern: /api_key\s*=\s*["']/, message: 'مفتاح API مخزن في الكود - استخدم متغيرات البيئة' },
                { pattern: /secret\s*=\s*["']/, message: 'بيانات سرية مخزنة في الكود' },
                { pattern: /token\s*=\s*["']/, message: 'توكن مخزن في الكود' }
            ];

            securityPatterns.forEach(({pattern, message}) => {
                if (pattern.test(code)) {
                    issues.security_issues.push(message);
                }
            });

            // تحليل أداء
            const lines = code.split('\n');
            lines.forEach((line, index) => {
                if ((line.includes('for') || line.includes('while')) && 
                    line.includes('+=') && (line.includes('"') || line.includes("'"))) {
                    issues.performance_issues.push(`سطر ${index + 1}: تجنب concatenation النصوص في الحلقات - استخدم list مع join`);
                }
            });

            // تحليل التعقيد
            const functionCount = (code.match(/function|def|class|void|int\s+main/g) || []).length;
            const loopCount = (code.match(/for|while/g) || []).length;
            const conditionCount = (code.match(/if|else|switch/g) || []).length;
            
            const complexityScore = functionCount * 2 + loopCount * 3 + conditionCount;
            
            if (complexityScore > 20) {
                issues.complexity_issues.push(`تعقيد عالي (${complexityScore}) - حاول تقسيم الكود إلى دوال أصغر`);
            }

            // تحليل أفضل الممارسات
            if (code.split('\n').length > 50 && functionCount < 3) {
                issues.best_practice_issues.push('كود طويل بدون دوال كافية - قسم الكود إلى دوال متخصصة');
            }

            if (!code.includes('//') && !code.includes('#') && !code.includes('--')) {
                issues.best_practice_issues.push('أضف تعليقات لتوضيح الكود');
            }

            // إحصائيات
            const totalIssues = issues.security_issues.length + issues.performance_issues.length + 
                              issues.complexity_issues.length + issues.best_practice_issues.length;

            return {
                ...issues,
                statistics: {
                    total_lines: lines.length,
                    total_issues: totalIssues,
                    estimated_quality: Math.max(0, 100 - (complexityScore + totalIssues * 5))
                }
            };
        }

        // عرض النتائج
        function displayResults(result) {
            const resultsDiv = document.getElementById('results-content');
            
            let html = `
                <div class="summary">
                    <h3>📈 ملخص التحليل</h3>
                    <p><strong>جودة الكود:</strong> ${result.statistics.estimated_quality}%</p>
                    <p><strong>عدد المشاكل:</strong> ${result.statistics.total_issues}</p>
                    <p><strong>عدد الأسطر:</strong> ${result.statistics.total_lines}</p>
                </div>
            `;

            // إظهار المشاكل حسب التصنيف
            const categories = [
                { key: 'security_issues', title: '🔒 المشاكل الأمنية', className: 'security' },
                { key: 'performance_issues', title: '🐢 مشاكل الأداء', className: 'performance' },
                { key: 'complexity_issues', title: '📊 مشاكل التعقيد', className: 'complexity' },
                { key: 'best_practice_issues', title: '💡 أفضل الممارسات', className: 'best-practice' }
            ];

            categories.forEach(category => {
                if (result[category.key] && result[category.key].length > 0) {
                    html += `<div class="category">
                        <h4>${category.title}</h4>
                        ${result[category.key].map(issue => 
                            `<div class="issue ${category.className}">${issue}</div>`
                        ).join('')}
                    </div>`;
                }
            });

            // إذا لم توجد مشاكل
            if (result.statistics.total_issues === 0) {
                html += `<div class="success">
                    <h3>🎉 ممتاز!</h3>
                    <p>كودك نظيف ولا توجد مشاكل كبيرة</p>
                </div>`;
            }

            resultsDiv.innerHTML = html;
            document.getElementById('results').style.display = 'block';
            
            // تأثير ظهور النتائج
            document.getElementById('results').classList.add('fade-in');
        }

        // تحميل الأمثلة التلقائية
        document.addEventListener('DOMContentLoaded', function() {
            document.getElementById('language').addEventListener('change', function() {
                const lang = this.value;
                if (examples[lang]) {
                    document.getElementById('code').value = examples[lang];
                }
            });
            
            // تحميل مثال افتراضي
            document.getElementById('code').value = examples.python;
        });
    </script>
</body>
  </html>
